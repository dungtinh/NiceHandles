<!-- Views/Infomations/Edit.cshtml ĐẦY ĐỦ -->
@model NiceHandles.Models.Infomation
@using NiceHandles.Models

@{
    ViewBag.Title = "Edit";
    var db = new NHModel();
    var hoso = db.HoSoes.Find(Model.hoso_id);
    var service = db.Services.Find(hoso.service_id);
    var contract = db.Contracts.Find(hoso.contract_id);
    var address = db.Addresses.Find(contract.address_id);

    // Pass data to ViewBag for partial views
    ViewBag.HoSo = hoso;
    ViewBag.Service = service;
    ViewBag.Contract = contract;
    ViewBag.Address = address;
    ViewBag.Database = db;
}

<style type="text/css">
    /* Improved Styles - Xóa lblKey và lblKey_r */
    legend {
        color: #2c3e50;
        font-weight: 600;
        font-size: 18px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 10px 20px;
        border-radius: 5px;
        margin-bottom: 20px;
    }

    .showhide:hover {
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .form-group {
        margin-bottom: 20px;
        padding: 10px;
        border-radius: 5px;
        transition: all 0.3s ease;
    }

        .form-group:hover {
            background-color: #f8f9fa;
        }

    .form-control {
        border: 1px solid #dee2e6;
        border-radius: 4px;
        padding: 8px 12px;
        transition: border-color 0.3s ease;
    }

        .form-control:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
        }

    .control-label {
        font-weight: 500;
        color: #495057;
        margin-bottom: 5px;
    }

    .nav-tabs {
        border-bottom: 2px solid #667eea;
        margin-bottom: 20px;
    }

        .nav-tabs > li > a {
            color: #495057;
            border: none;
            padding: 10px 15px;
            transition: all 0.3s ease;
            border-radius: 5px 5px 0 0;
        }

            .nav-tabs > li > a:hover {
                background-color: #f8f9fa;
            }

        .nav-tabs > li.active > a {
            color: white;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
        }

    .btn-check:checked + .btn-outline-primary {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border-color: #667eea;
    }

    fieldset {
        border: 1px solid #dee2e6;
        padding: 20px;
        border-radius: 8px;
        margin-bottom: 20px;
    }

    .tab-content {
        padding: 20px;
        background-color: #f8f9fa;
        border-radius: 0 0 8px 8px;
    }

    .btn-primary {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border: none;
        padding: 10px 20px;
        font-weight: 500;
    }

        .btn-primary:hover {
            background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
        }
</style>

<h2>@hoso.name</h2>

@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()

    <div class="form-horizontal">
        <h4>@service.name</h4>
        <p class="text-muted">@address.name</p>
        <hr />
        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
        @Html.HiddenFor(model => model.id)
        @Html.HiddenFor(model => model.hoso_id)

        <ul class="nav nav-tabs">
            <li class="active"><a data-toggle="tab" href="#chusohuu">Người đứng tên bìa (a)</a></li>
            <li><a data-toggle="tab" href="#dat">Thửa đất (b)</a></li>
            <li><a data-toggle="tab" href="#uyquyen">Người được ủy quyền (e)</a></li>
            <li><a data-toggle="tab" href="#thongtinthem">Thông tin thêm (c)</a></li>
            <li class="hide"><a data-toggle="tab" href="#chuyennhuong">Biến động (d)</a></li>
            <li class="hide"><a data-toggle="tab" href="#landau">Cấp lần đầu (f)</a></li>
            <li class="hide"><a data-toggle="tab" href="#caplai">Cấp lại (g)</a></li>
            <li class="hide"><a data-toggle="tab" href="#capdoi">Cấp đổi (h)</a></li>
            <li class="hide"><a data-toggle="tab" href="#hopthua">Hợp thửa (i)</a></li>
            <li class="hide"><a data-toggle="tab" href="#tachthua">Tách thửa (k)</a></li>
            <li class="hide"><a data-toggle="tab" href="#dinhchinh">Đính chính (l)</a></li>
            <li class="hide"><a data-toggle="tab" href="#chuyenvuon">Chuyển vườn (m)</a></li>
            <li><a data-toggle="tab" href="#download">Tải tài liệu</a></li>
        </ul>

        <div class="tab-content">
            <!-- Tab Chủ sở hữu -->
            <div id="chusohuu" class="tab-pane fade in active">
                @Html.Partial("_PartialChuSoHuu", Model)
            </div>

            <!-- Tab Thửa đất -->
            <div id="dat" class="tab-pane fade">
                @Html.Partial("_PartialThuaDat", Model)
            </div>

            <!-- Tab Ủy quyền -->
            <div id="uyquyen" class="tab-pane fade">
                @Html.Partial("_PartialUyQuyen", Model)
            </div>

            <!-- Tab Thông tin thêm -->
            <div id="thongtinthem" class="tab-pane fade">
                @Html.Partial("_PartialThongTinThem", Model)
            </div>

            <!-- Tab Chuyển nhượng -->
            <div id="chuyennhuong" class="tab-pane fade">
                @Html.Partial("_PartialChuyenNhuong", Model)
            </div>

            <!-- Tab Lần đầu -->
            <div id="landau" class="tab-pane fade">
                <br />
                @Html.Partial("_PartialLanDau", Model)
            </div>

            <!-- Tab Cấp lại -->
            <div id="caplai" class="tab-pane fade">
                @Html.Partial("_PartialCapLai", Model)
            </div>

            <!-- Tab Cấp đổi -->
            <div id="capdoi" class="tab-pane fade">
                @Html.Partial("_PartialCapDoi", Model)
            </div>

            <!-- Tab Hợp thửa -->
            <div id="hopthua" class="tab-pane fade">
                <br />
                @Html.Partial("_PartialHopThua")
            </div>

            <!-- Tab Tách thửa -->
            <div id="tachthua" class="tab-pane fade">
                <br />
                @Html.Partial("_PartialTachThua")
            </div>

            <!-- Tab Đính chính -->
            <div id="dinhchinh" class="tab-pane fade">
                @Html.Partial("_PartialDinhChinh", Model)
            </div>

            <!-- Tab Chuyển vườn -->
            <div id="chuyenvuon" class="tab-pane fade">
                @Html.Partial("_PartialChuyenVuon", Model)
            </div>

            <!-- Tab Download -->
            <div id="download" class="tab-pane fade">
                @Html.Partial("_PartialDownload", Model)
            </div>
        </div>

        <div class="form-group mt-4">
            <div class="col-md-offset-2 col-md-10">
                <input type="submit" value="Lưu lại" class="btn btn-primary" onclick="BonusSave()" />
                @Html.ActionLink("Về danh sách", "Details", "Hosoes", new { id = Model.hoso_id }, new { @class = "btn btn-secondary ml-2" })
            </div>
        </div>
    </div>
}

<iframe id="my_iframe" style="display:none;"></iframe>

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
    <script src="~/Scripts/moment.min.js"></script>
    @Html.Partial("_PartialScripts", service.code)
}