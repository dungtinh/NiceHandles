@model NiceHandles.Models.XInOut
@using NiceHandles.Models

@{
    ViewBag.Title = "Chi tiết";
}

<h2>Chi tiết</h2>

<div>
    <h4>Thu chi</h4>
    <hr />
    <dl class="dl-horizontal">

        <dt>
            Người thực hiện
        </dt>
        <dd>
            @Html.DropDownListFor(model => model.obj.account_id, Model.account, new { @class = "form-control", disabled = "disabled" })
        </dd>
        <br />
        <dt>
            Loại
        </dt>

        <dd>
            @Html.DropDownListFor(model => model.obj.type, Model.types, new { @class = "form-control", @onchange = "FillCategory()", disabled = "disabled" })
        </dd>
        <br />
        <dt>
            Loại chi tiết
        </dt>

        <dd>
            @Html.DropDownListFor(model => model.obj.category_id, Model.categories, new { @class = "form-control", disabled = "disabled" })
        </dd>
        <br />
        <dt>
            Thời gian thực hiện
        </dt>

        <dd>
            @Model.obj.time.ToString("HH:mm dd/MM/yyyy")
        </dd>
        <br />
        <dt>
            Số tiền
        </dt>

        <dd>
            @Model.amount.ToString("N0")
        </dd>
        <br />
        <dt>
            Ghi chú
        </dt>

        <dd>
            @Html.DisplayFor(model => model.obj.note)
        </dd>

    </dl>
    <p>
        @if (!Model.obj.state.HasValue)
        {
            @Html.ActionLink("Sửa | ", "Edit", new { id = Model.obj.id })
        }
        @if (Model.obj.contract_id.HasValue)
        {
            @Html.ActionLink("Về danh sách", "Details", "Contracts", new { id = Model.obj.contract_id }, null)
        }
        else
        {
            @Html.ActionLink("Về danh sách", "Index")
        }

    </p>

    @{
        var db = (NHModel)ViewBag.db;
        var cate = db.Categories.Find(Model.obj.category_id);
    }
    @if (cate.wf == (int)XCategory.eWf.Co)
    {
        <br />
        <h4>Quá trình</h4>
        <hr />
        <p>
            @Html.ActionLink("Thêm mới", "Create", "wf_inout", new { id = Model.obj.id }, new { @class = "btn btn-primary" })
        </p>
        <table class="table table-hover">
            <tr class="text-primary">
                <th>Thời gian</th>
                <th>Người thực hiện</th>
                <th>Trạng thái</th>
                <th>Ghi chú</th>
            </tr>
            @foreach (var item in ViewBag.lst as wf_inout[])
            {
                var acc = db.Accounts.Find(item.account_id);
                <tr>
                    <td>
                        @item.time.ToString("HH:mm dd/MM/yyyy")
                    </td>
                    <td>
                        @acc.fullname
                    </td>
                    <td>
                        @XInOut.sStatus[item.status]
                    </td>
                    <td>
                        @item.note
                    </td>
                </tr>
            }

        </table>
    }
</div>
