@model IEnumerable<NiceHandles.Models.QuanTriVanHanh>

@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
    int i = 0;
}

<h2>Index</h2>

<p>
    @Html.ActionLink("Create New", "Create")
</p>
<p>Template bản in: QuanTriVanHanh.docx</p>
<table class="table">
    <tr>
        <th>
            STT
        </th>
        <th>
            Kế hoạch
        </th>
        <th>
            Quy trình
        </th>
        <th>
            Báo cáo
        </th>
        <th></th>
    </tr>

    @foreach (var item in Model)
    {
        i++;
        <tr>
            <td>
                @i
            </td>
            <td>
                @Html.Raw(item.plans)
            </td>
            <td>
                @Html.Raw(item.workflows)
            </td>
            <td>
                @Html.Raw(item.reports)
            </td>
            <td>
                <button class="btn btn-primary" onclick="Print(@item.id);">Bản In</button>  |
                @Html.ActionLink("Sửa", "Edit", new { id = item.id }) |
                @Html.ActionLink("Xóa", "Delete", new { id = item.id })
            </td>
        </tr>
    }

</table>
<iframe id="my_iframe" style="display:none;"></iframe>
@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
    <script>
        function Print(id) {
            $.ajax({
                url: '/QuanTriVanHanhs/Print',
                data: {
                    id: id
                },
                type: "GET",
                dataType: "JSON",
                success: function (url) {
                    document.getElementById('my_iframe').src = url;
                }
            });
        }
    </script>
}