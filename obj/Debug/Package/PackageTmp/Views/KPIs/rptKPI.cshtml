
@{
    ViewBag.Title = "Chấm công";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<div id="chartContainer" style="height: auto; max-width: auto; margin: 0px auto;"></div>
@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
    <script src="https://canvasjs.com/assets/script/jquery.canvasjs.min.js"></script>
    <script>
        window.onload = function () {
            $.ajax({
                url: '/KPIs/GetKPI',
                type: "GET",
                dataType: "JSON",
                success: function (jData) {
                    for (var i = 0; i < jData.length; i++) {
                        if (jData[i].dataPoints) {
                            for (var y = 0; y < jData[i].dataPoints.length; y++) {
                                var datax = jData[i].dataPoints[y].x;
                                var datay = jData[i].dataPoints[y].y;
                                if (datax) {
                                    jData[i].dataPoints[y].x = new Date(jData[i].dataPoints[y].x);
                                } else {
                                    jData[i].dataPoints[y].x = new Date();
                                }
                            }
                        }
                    }
                    var options = {
                        exportEnabled: true,
                        animationEnabled: true,
                        title: {
                            text: "KPI"
                        },
                        subtitles: [{
                            text: "_"
                        }],
                        axisX: {
                            title: "",
                            valueFormatString: "DD/MM"
                        },
                        axisY: {
                            title: "Chỉ tiêu",
                            titleFontColor: "#4F81BC",
                            lineColor: "#4F81BC",
                            labelFontColor: "#4F81BC",
                            tickColor: "#4F81BC",
                            includeZero: false,
                            valueFormatString: "#,##0 đơn vị"
                        },
                        toolTip: {
                            shared: true
                        },
                        legend: {
                            cursor: "pointer",
                            itemclick: toggleDataSeries
                        },
                        data: jData
                    };
                    $("#chartContainer").CanvasJSChart(options);
                }
            });
            function toggleDataSeries(e) {
                if (typeof (e.dataSeries.visible) === "undefined" || e.dataSeries.visible) {
                    e.dataSeries.visible = false;
                } else {
                    e.dataSeries.visible = true;
                }
                e.chart.render();
            }

        }</script>
}
